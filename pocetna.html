<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Rezultati</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.js"></script>
  </head>
  <body>
    <p id="ime">Korisničko ime:</p>
		<input type="text" id="username" />
		<br />
		<p id="lozinka">Lozinka:</p>
		<input type="password" id="password" />
		<br />
		<button id="btn_prijava">Prijavi se</button>
    <script type="text/javascript">
    //varijable za spremanje podataka
    var username = null, pass = null;

    $(document).ready(function(){
      console.log("Na stranici pocetna.html");
      $("#btn_prijava").on("click", Prijava)
    });
    function Prijava(){
      console.log("U fji prijava");
      //spremam potrebne podatke koje ću slati ajax upitom
      username = $("#username").val();
      //console.log("Korisnicko ime je " + username);
      pass = $("#password").val();
      //console.log("Lozinka je " + pass);
      //ajax upit kojim provjeravam je li korisnik unesao točne podatke pri registraciji
      //ako jest, povrati podaci su rezultati ispita tog korisnika
      //ako nije, poruka o greški - ili je lozinka kriva, ili takvo korisničko ime ne postoji
      $.ajax({
        url: "pocetna.php",
        data:
        {
          username: username,
          pass: pass
        },
        dataType: "json",
        success: function(data) {
          console.log(data.info);
          console.log("Greška je: " +data.greska);
          console.log("Administrator: " +data.admin);
          //ukoliko je prijava korisnika bila uspješna te se ne radi o administratoru, treba ispisati njegove rezultate
          if(!data.admin && data.greska === 0) {
            window.location.href = "rezultati.html";
            localStorage.setItem("username", username);
            localStorage.setItem("pass", pass);
            localStorage.setItem("ime", data.ime_studenta);
            localStorage.setItem("prezime", data.prezime_studenta);
            localStorage.setItem("id", data.id);
          }
          //ukoliko je prijava administatora bila uspješna, treba ispisati forme za unos studenata
          else if(data.admin && data.greska === 0)
            window.location.href = "administrator.html";
          //ukoliko je došlo do neke greške, ispiši podatke o njoj
          else {
            alert(data.info);
            $("#username").val("");
            $("#password").val("");
          }
        },
        error : function(xhr, status) {
          if(status !== "null")
          console.log("Nesto nije u redu s Ajax upitom. Status: " + status + ".");
        }
      });
    }


    function unosStudenata() {

    }
    </script>
  </body>


</html>

